# @sylphx/babel-plugin-silk

## 2.0.6

### Patch Changes

- dd5353d: ### Changed

  - Updated documentation to correct bundle size claims from 500B to 1.6KB gzipped
  - Fixed bundle size comparison tables with accurate percentages
  - Updated size limit configuration to match actual measurements
  - Updated CHANGELOG.md files across packages with latest improvements

  ### Fixed

  - Corrected inaccurate bundle size claims throughout documentation
  - Ensured all framework integration tables reflect realistic bundle sizes

- Updated dependencies [dd5353d]
  - @sylphx/silk@2.2.2

## 2.0.5

### Patch Changes

- ## Fixes

  - Clarified Silk's Zero Codegen strategy in documentation
  - Fixed Turbopack support documentation - CLI codegen is required for Turbopack mode
  - Updated Next.js plugin README with accurate Webpack vs Turbopack setup instructions
  - Removed NODE_ENV auto-detection from runtime to maintain Zero Codegen principle
  - Added comprehensive framework testing and documentation review

  ## Documentation

  - Updated main README.md with accurate framework support matrix
  - Enhanced FRAMEWORK_QUICKSTART.md with detailed Next.js Webpack/Turbopack comparison
  - Clarified that Webpack mode supports true zero-codegen while Turbopack requires CLI
  - Added feature comparison tables for Next.js build modes
  - Fixed inconsistent documentation across all framework guides

- Updated dependencies
  - @sylphx/silk@2.2.1

## 2.0.4

### Patch Changes

- 6c72939: fix(turbopack): unify class name generation between CLI and Babel plugin

  Fixes critical class name mismatch when using Turbopack with Babel. Previously:

  - CLI generated counter-based atomic names (`.a0`, `.a1`)
  - Babel plugin generated readable names (`silk_position_relative_h65s`)

  Now both use deterministic hash-based class names:

  - Production: `s{hash}` (e.g., `s1ehecwq`)
  - Development: `silk-{hash}` (e.g., `silk-1ehecwq`)

  Changes:

  - Unified hash function to murmurHash2 in both CLI and Babel plugin
  - Unified input format: `property-value-variant`
  - Unified output format: `s{hash}` for production (no separator, shorter)
  - CLI now uses `shortClassNames: false` for deterministic hash-based names
  - Babel plugin simplified production format from digit mapping to `s{hash}`

  This ensures CSS generated by CLI matches class names inserted by Babel plugin during compilation.

## 2.0.3

### Patch Changes

- Fix package.json exports for Babel compatibility - add require field and remove type: module

## 2.0.1

### Patch Changes

- **CRITICAL FIX**: Fix invalid CSS class names starting with digits in production mode

  ## Problem

  Production mode generated class names that start with digits (e.g., `.1a7f3b2`, `.17hvj21`), which violate the CSS identifier specification. Browsers silently drop these invalid rules, causing styles to not be applied.

  **Impact**: In production builds, approximately 28% of CSS rules were being dropped by browsers (rules where the hash started with 0-9).

  ## Solution

  Implemented an optimized digit-to-letter mapping that:

  - Maps leading digits to letters (0→g, 1→h, 2→i, ..., 9→p)
  - Maintains optimal compression (6-7 chars average)
  - Ensures 100% CSS identifier compliance
  - Zero collision risk (deterministic 1:1 mapping)

  ## Results

  **Before** (broken):

  ```css
  .1gv0lpf {
    padding: 2rem;
  } /* ❌ Invalid - dropped by browser */
  .0p2rk1o {
    margin: 1rem;
  } /* ❌ Invalid - dropped by browser */
  ```

  **After** (fixed):

  ```css
  .hgv0lpf {
    padding: 2rem;
  } /* ✅ Valid - 1→h mapping */
  .gp2rk1o {
    margin: 1rem;
  } /* ✅ Valid - 0→g mapping */
  ```

  ## Compression Optimization

  Unlike naive prefix solutions, this approach maintains optimal file size:

  - No prefix: 6-7 chars (optimal compression)
  - Custom prefix: prefix + 6-7 chars (branding support)

  **File size comparison** (10,000 CSS rules):

  - Old bug: 65KB (but 28% rules dropped!)
  - Naive fix (s + hash): 80KB (+15KB)
  - **Optimized fix**: 65KB (+0KB) ✅

  ## Configuration

  ```typescript
  // Optimal compression (no prefix)
  babelOptions: {
    production: true,
    // No classPrefix = 6-7 char class names
  }
  // Output: .hgv0lpf, .yfr0d6

  // Custom branding
  babelOptions: {
    production: true,
    classPrefix: 'app',
  }
  // Output: .apphgv0lpf, .appyfr0d6
  ```
